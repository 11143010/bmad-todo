# BMad Test Suite

## Overview

This test suite covers BMad with:

- **Unit Tests** (Vitest): Pinia stores, business logic in `src/modules/`
- **E2E Tests** (Playwright): Critical user flows, PWA functionality

## Quick Start

```bash
# Install dependencies
npm install

# Run unit tests
npm run test:unit

# Run E2E tests (requires dev server)
npm run test:e2e

# Run E2E in headed mode (for debugging)
npm run test:e2e:headed
```

## Directory Structure

```
tests/
├── e2e/                    # Playwright E2E tests
│   └── core-flows.spec.ts  # Core user journey tests
├── unit/                   # Vitest unit tests
│   └── metabolism.store.test.ts
└── support/                # Shared test infrastructure
    ├── fixtures/           # Playwright fixtures
    │   └── index.ts
    ├── helpers/            # Utility functions
    └── vitest-setup.ts     # Unit test setup
```

## Key Patterns

### Fixture Architecture

E2E tests use custom fixtures for:

- `cleanDatabase`: Auto-clears IndexedDB before each test
- `createTask`: Helper to create tasks via UI

```typescript
import { test, expect } from "../support/fixtures";

test("example", async ({ page, createTask }) => {
  await createTask("My task", "snack");
});
```

### Unit Test Mocking

Stores are tested with mocked RxDB. See `vitest-setup.ts` for mock configuration.

## CI Integration

Tests run on GitHub Actions. See `.github/workflows/test.yml`.

## Coverage

Generate coverage report:

```bash
npm run test:unit -- --coverage
```

---

**Generated by:** BMad TEA Agent
